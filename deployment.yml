apiVersion: apps/v1
kind: Deployment
metadata:
  name: memo-api-deployment
spec:
  replicas: 2 # ğŸ‘ˆ ì‹œì‘ë¶€í„° Podë¥¼ 2ê°œ ë„ì›Œë´…ë‹ˆë‹¤.
  selector:
    matchLabels:
      app: memo-api # ì´ Deploymentê°€ ê´€ë¦¬í•  Podë¥¼ ì°¾ëŠ” ê¼¬ë¦¬í‘œ
  template: # Podë¥¼ ì–´ë–»ê²Œ ë§Œë“¤ì§€ì— ëŒ€í•œ ì„¤ê³„ë„ ('Pod í…œí”Œë¦¿')
    metadata:
      labels:
        app: memo-api # Podì— ë¶™ì—¬ì¤„ ê¼¬ë¦¬í‘œ (ìœ„ selectorì™€ ì¼ì¹˜!)
    spec:
      containers:
        - name: memo-api-container
          image: 423458036718.dkr.ecr.ap-northeast-2.amazonaws.com/my-spring-app:latest
          ports:
            - containerPort: 8080
          env:
            - name: DB_URL # ì»¨í…Œì´ë„ˆì— ì„¤ì •ë  í™˜ê²½ ë³€ìˆ˜ ì´ë¦„
              valueFrom:
                secretKeyRef:
                  name: my-db-secret # ì‚¬ìš©í•  Secretì˜ ì´ë¦„
                  key: DB_URL       # Secret ì•ˆì—ì„œ ê°€ì ¸ì˜¬ ë°ì´í„°ì˜ Key
            - name: DB_USERNAME
              valueFrom:
                secretKeyRef:
                  name: my-db-secret
                  key: DB_USERNAME
            - name: DB_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: my-db-secret
                  key: DB_PASSWORD